<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Canlı Destek İhtiyaç Formu</title>
  <style>
    :root{
      --bg: #0f172a;         /* slate-900 */
      --card: #111827;       /* gray-900 */
      --muted: #94a3b8;      /* slate-400 */
      --text: #e5e7eb;       /* gray-200 */
      --primary: #22d3ee;    /* cyan-400 */
      --accent: #34d399;     /* emerald-400 */
      --danger: #f87171;     /* red-400 */
      --ring: rgba(34, 211, 238, .5);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 10% -10%, rgba(34,211,238,.08), transparent 60%),
                  radial-gradient(1000px 600px at 110% 10%, rgba(52,211,153,.05), transparent 60%), var(--bg);
      color:var(--text);
    }
    header{position: sticky; top:0; z-index:10; backdrop-filter: blur(8px);
      background: linear-gradient(180deg, rgba(15,23,42,.9), rgba(15,23,42,.65));
      border-bottom: 1px solid rgba(148,163,184,.15);}    
    .container{max-width:1100px; margin:0 auto; padding:18px 16px}
    .title{display:flex; gap:14px; align-items:center}
    .logo{width:36px; height:36px; border-radius:10px; background:linear-gradient(135deg, var(--primary), var(--accent)); box-shadow: var(--shadow)}
    h1{font-size: clamp(20px, 2.8vw, 28px); margin:0; letter-spacing:.2px}
    .muted{color:var(--muted); font-size:14px}

    form{margin-top:16px; display:grid; gap:16px}
    .card{background: linear-gradient(180deg, rgba(17,24,39,.9), rgba(17,24,39,.85)); border:1px solid rgba(148,163,184,.18); padding:16px; border-radius: var(--radius); box-shadow: var(--shadow)}
    .grid{display:grid; gap:12px}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width: 860px){ .grid.cols-2, .grid.cols-3{grid-template-columns:1fr} }
    label{font-size:14px; color:var(--text)}
    input[type="text"], input[type="url"], input[type="number"], select, textarea{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(148,163,184,.18); background:var(--card); color:var(--text);
      outline:none; box-shadow: var(--shadow)
    }
    textarea{min-height:90px; resize:vertical}

    fieldset{border:1px dashed rgba(148,163,184,.25); border-radius:14px; padding:12px}
    legend{padding:4px 8px; border-radius:10px; background:rgba(34,211,238,.12); border:1px solid rgba(34,211,238,.25); font-weight:600}
    .option{display:flex; gap:10px; align-items:flex-start; padding:10px; border-radius:12px}
    .option:hover{background:rgba(148,163,184,.06)}
    .option input[type="checkbox"]{width:18px; height:18px; accent-color: var(--primary); margin-top:2px}

    .toolbar{display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top:14px}
    .toolbar > *{border-radius: 12px; border:1px solid rgba(148,163,184,.18); background: var(--card); color:var(--text); box-shadow: var(--shadow)}
    .search{flex:1 1 260px; display:flex; align-items:center; gap:10px; padding:10px 12px}
    .search input{width:100%; padding:8px 10px; background:transparent; border:0; outline: none; color:var(--text)}

    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid rgba(148,163,184,.18); background:var(--card); color:var(--text); cursor:pointer; box-shadow: var(--shadow); transition:.15s transform}
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{border-color: transparent; background: linear-gradient(135deg, var(--primary), var(--accent)); color:#0b1220; font-weight:600}
    .btn.danger{border-color: rgba(248,113,113,.25)}
    .btn:disabled{opacity:.6; cursor:not-allowed}

    .summary{background: linear-gradient(180deg, rgba(17,24,39,.9), rgba(17,24,39,.86));
      border:1px solid rgba(148,163,184,.18); border-radius: var(--radius); box-shadow: var(--shadow); padding:16px}
    .summary h3{margin:0 0 10px}
    .summary pre{white-space:pre-wrap; word-wrap:break-word; background:#0b1220; border-radius:12px; padding:12px; border:1px solid rgba(148,163,184,.2)}

    .footer{opacity:.7; font-size:12px; text-align:center; margin:24px 0 40px}
    .pill{display:inline-block; padding:3px 8px; border-radius:999px; background:rgba(34,211,238,.12); border:1px solid rgba(34,211,238,.25); font-size:12px; color:var(--text)}
    .muted-row{color:var(--muted); font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="title">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Canlı Destek İhtiyaç Formu</h1>
          <div class="muted">Benzer özellikleri başlıklar altında topla, form olarak doldur.</div>
        </div>
      </div>
      <div class="toolbar">
        <div class="search" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="10" cy="10" r="6" stroke="currentColor" stroke-width="2"/></svg>
          <input id="q" type="search" placeholder="Formda özellik ara... (örn: WhatsApp, CRM, API)" autocomplete="off" />
        </div>
        <button class="btn" id="expandAll">Tüm Başlıkları Aç</button>
        <button class="btn" id="collapseAll">Hepsini Kapat</button>
        <span class="pill" id="selStat">0 özellik seçildi</span>
      </div>
    </div>
  </header>

  <main class="container">

    <!-- Şirket Bilgileri -->
    <section class="card">
      <h2 style="margin:0 0 12px">Şirket Bilgileri</h2>
      <div class="grid cols-3">
        <div>
          <label>Şirket / Marka Adı</label>
          <input id="company" type="text" placeholder="Örn: Hyper Machine" />
        </div>
        <div>
          <label>Web Sitesi</label>
          <input id="website" type="url" placeholder="https://..." />
        </div>
        <div>
          <label>Sektör</label>
          <select id="industry">
            <option value="">Seçiniz</option>
            <option>Perakende / E-Ticaret</option>
            <option>Finans / Bankacılık</option>
            <option>Enerji / Elektrik</option>
            <option>Telekom</option>
            <option>Sağlık</option>
            <option>Diğer</option>
          </select>
        </div>
      </div>
      <div class="grid cols-3" style="margin-top:10px">
        <div>
          <label>Temsilci Sayısı</label>
          <input id="agentCount" type="number" min="1" step="1" placeholder="Örn: 10" />
        </div>
        <div>
          <label>İletişim E-postası</label>
          <input id="email" type="text" placeholder="destek@..." />
        </div>
        <div>
          <label>Notlar</label>
          <input id="notes" type="text" placeholder="Özel ihtiyaçlar..." />
        </div>
      </div>
    </section>

    <!-- Özellik Başlıkları (fieldset) -->
    <form id="featureForm">
      <details class="card" open>
        <summary><strong>Kanallar & Entegrasyonlar</strong> <span class="muted-row">(Facebook, Instagram, WhatsApp, Apple Business Chat...)</span></summary>
        <fieldset style="margin-top:10px">
          <legend>Mesaj Kanalları</legend>
          <div class="grid cols-2" id="grp-kanal"></div>
        </fieldset>
        <fieldset style="margin-top:10px">
          <legend>Mobil & Telefon</legend>
          <div class="grid cols-2" id="grp-mobil"></div>
        </fieldset>
      </details>

      <details class="card" open>
        <summary><strong>Sohbet Deneyimi</strong> <span class="muted-row">(Pencere, dosya, yazım, çoklu temsilci...)</span></summary>
        <fieldset style="margin-top:10px">
          <legend>Sohbet Penceresi</legend>
          <div class="grid cols-2" id="grp-pencere"></div>
        </fieldset>
        <fieldset style="margin-top:10px">
          <legend>Agent & Mesaj</legend>
          <div class="grid cols-2" id="grp-agent"></div>
        </fieldset>
      </details>

      <details class="card" open>
        <summary><strong>Ziyaretçi İzleme & Yönlendirme</strong></summary>
        <div class="grid cols-2" id="grp-ziyaret"></div>
      </details>

      <details class="card" open>
        <summary><strong>Chatbot & Yapay Zeka</strong></summary>
        <div class="grid cols-2" id="grp-ai"></div>
      </details>

      <details class="card" open>
        <summary><strong>Pazarlama & Analitik</strong></summary>
        <div class="grid cols-2" id="grp-marketing"></div>
      </details>

      <details class="card" open>
        <summary><strong>Operasyon & Ekip Yönetimi</strong></summary>
        <div class="grid cols-2" id="grp-operasyon"></div>
      </details>

      <details class="card" open>
        <summary><strong>CRM & Sipariş</strong></summary>
        <div class="grid cols-2" id="grp-crm"></div>
      </details>

      <details class="card" open>
        <summary><strong>Geliştirici & API</strong></summary>
        <div class="grid cols-2" id="grp-dev"></div>
      </details>

      <details class="card" open>
        <summary><strong>Güvenlik & Uyum</strong></summary>
        <div class="grid cols-2" id="grp-security"></div>
      </details>

      <div class="card" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between">
        <div class="muted">Arama: <span class="pill" id="filterStat">tüm özellikler</span></div>
        <div style="display:flex; gap:10px">
          <button type="button" class="btn" id="selectAll">Görünenleri Seç</button>
          <button type="button" class="btn" id="clearAll">Seçimi Temizle</button>
          <button type="button" class="btn primary" id="buildSummary">Özet Oluştur</button>
        </div>
      </div>
    </form>

    <section class="summary" id="summary" style="display:none">
      <h3>Teklif Özeti</h3>
      <pre id="summaryText"></pre>
      <div style="display:flex; gap:10px; flex-wrap:wrap">
        <button id="copyBtn" class="btn">Özeti Kopyala</button>
        <button id="jsonBtn" class="btn">JSON indir</button>
        <button id="csvBtn" class="btn">CSV indir</button>
        <button id="shareBtn" class="btn">Paylaşılabilir Bağlantı</button>
      </div>
    </section>

    <p class="footer">Hazırlayan: <strong>Hyper Machine</strong> • <span class="muted">Form yanıtları cihazında saklanır (localStorage). Tamamen istemci tarafıdır.</span></p>
  </main>

  <script>
    // ---- VERİ MODELİ (Gruplar) ----
    const GROUPS = {
      kanal: [
        "Facebook, Instagram, Viber, Telegram Entegrasyonları",
        "Whatsapp Entegrasyonu (Ek olarak ücretlendirilmektedir)",
        "Apple Business Chat",
        "Facebook, Instagram ve Telegram'da Sesli Mesajlar"
      ],
      mobil: [
        "Mobil Uygulama SDK",
        "Telefon+ Modülü",
        "Görüntülü Görüşme Modülü"
      ],
      pencere: [
        "Canlı Destek",
        "Canlı destek penceresinde özelleştirilmiş sesler",
        "Sohbet öncesi butonlar",
        "Dosya gönderme-alma",
        "Sohbet penceresinde temsilci fotoğrafı gösterme",
        "Sınırsız sitede sınırsız sohbet penceresi",
        "Mobil cihazların tamamına uygun sohbet penceresi",
        "Mobil sohbet penceresi özelleştirme",
        "Gönderim sonrası yanıt düzenleme"
      ],
      agent: [
        "Yazım denetimi",
        "Taslak cevaplar",
        "Ziyaretçinin yazdığının anlık gösterimi",
        "Çoklu temsilcili sohbetler",
        "Temsilciler arası sohebt aktarımı",
        "Temsilci Durum Bilgisi",
        "Farklı kanallara farklı temsilciler atama",
        "Sohbet konuları",
        "Kısayollar",
        "Tüm cihazlarda çalışma"
      ],
      ziyaret: [
        "Canlı ziyaretçi takibi ve sitedeki ziyaretçiye manuel mesaj gönderme",
        "IP adresi, coğrafi bölge ve ziyaret kaynağı dahil tüm ziyaretçi bilgileri",
        "Sitenizde ziyaretçilerinizi yönlendirmek için işaretçi aracı",
        "Sohbetleri ziyaretçinin coğrafi konumuna göre dağıtma",
        "Akıllı tetikleyicilerle hedefli sohbetler başlatma",
        "Mesai saatleri belirleme",
        "Geri Aramalar"
      ],
      ai: [
        "AI Asistanı Modülü",
        "YZ YardımcısıModülü",
        "Chatbot - Sohbet Botları"
      ],
      marketing: [
        "Etkileşimli mesaj kampanyaları",
        "Google Analytics Entegrasyonu",
        "Pazarlama İstatistikleri",
        "Müşteriler tarafından servis kalitesi geribildirimleri"
      ],
      operasyon: [
        "Ekip içi sohbet",
        "Sohbet yönlendirme",
        "Sohbet kurtarma",
        "Kanalları ayarlarıyla kopyalama",
        "Departmanlar",
        "Temsilci istatistikleri",
        "Temsilci sayısı"
      ],
      crm: [
        "CRM Modülü ile müşteri ve satış takibi",
        "Online mağazanızdaki formlar üzerinden sipariş işleme",
        "Excel'e veri dökümü alma",
        "CRM sağlayıcılarla tek tıkla entegrasyon"
      ],
      dev: [
        "Sohbet API",
        "Site Webhookları",
        "Yazılımınızla entegrasyon için JavaScript API ve WebHooklar"
      ],
      security: [
        "Spam koruması",
        "Kişisel Veri İşleme İzni (KVKK, GDPR vb.)",
        "Sohbet arşivi"
      ]
    };

    const ALL_FEATURES = Object.values(GROUPS).flat();

    const STORAGE_KEY = 'canli_destek_form_v2';

    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const state = {
      query: '',
      selected: new Set(),
      fields: {company:'', website:'', industry:'', agentCount:'', email:'', notes:''}
    };

    function hydrate(){
      const saved = localStorage.getItem(STORAGE_KEY);
      if(!saved) return;
      try{
        const data = JSON.parse(saved);
        if(Array.isArray(data.selected)) data.selected.forEach(f => state.selected.add(f));
        if(data.fields) state.fields = {...state.fields, ...data.fields};
      }catch(e){}
    }
    function persist(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify({selected:[...state.selected], fields: state.fields}));
    }

    function bindCompanyFields(){
      const ids = ['company','website','industry','agentCount','email','notes'];
      ids.forEach(id => {
        const el = document.getElementById(id);
        if(!el) return;
        if(state.fields[id]) el.value = state.fields[id];
        el.addEventListener('input', (e)=>{ state.fields[id] = e.target.value; persist(); });
      });
    }

    function makeOption(label){
      const wrap = document.createElement('label');
      wrap.className = 'option';
      const cb = document.createElement('input');
      cb.type = 'checkbox';
      cb.checked = state.selected.has(label);
      cb.addEventListener('change', ()=> toggle(label));
      const span = document.createElement('span'); span.textContent = label;
      wrap.appendChild(cb); wrap.appendChild(span);
      return wrap;
    }

    function renderGroups(){
      // Clear containers
      Object.keys(GROUPS).forEach(key => { const c = document.getElementById('grp-'+key); if(c) c.innerHTML=''; });
      // Filter
      const q = state.query.trim().toLowerCase();
      $('#filterStat').textContent = q? `"${q}" ile filtrelendi` : 'tüm özellikler';
      const matcher = (s)=> s.toLowerCase().includes(q);

      // Render each group
      for(const [key, items] of Object.entries(GROUPS)){
        const container = document.getElementById('grp-'+key);
        if(!container) continue;
        items.filter(matcher).forEach(item => container.appendChild(makeOption(item)));
      }

      updateSelStat();
    }

    function toggle(label){
      if(state.selected.has(label)) state.selected.delete(label); else state.selected.add(label);
      persist(); updateSelStat();
    }

    function updateSelStat(){ $('#selStat').textContent = `${state.selected.size} özellik seçildi`; }

    function selectAllVisible(){
      const q = state.query.trim().toLowerCase();
      const matcher = (s)=> s.toLowerCase().includes(q);
      Object.values(GROUPS).flat().filter(matcher).forEach(i=> state.selected.add(i));
      persist(); renderGroups();
    }
    function clearAll(){ state.selected.clear(); persist(); renderGroups(); }

    function expandAll(){ $$('details').forEach(d=> d.open = true); }
    function collapseAll(){ $$('details').forEach(d=> d.open = false); }

    function buildSummary(){
      const payload = {
        company: state.fields.company || null,
        website: state.fields.website || null,
        industry: state.fields.industry || null,
        agentCount: state.fields.agentCount || null,
        email: state.fields.email || null,
        notes: state.fields.notes || null,
        selectedByGroup: {},
        selectedCount: state.selected.size,
        exportedAt: new Date().toISOString()
      };
      for(const [key, items] of Object.entries(GROUPS)){
        const chosen = items.filter(i=> state.selected.has(i));
        if(chosen.length) payload.selectedByGroup[key] = chosen;
      }
      const pretty = JSON.stringify(payload, null, 2);
      $('#summaryText').textContent = pretty;
      $('#summary').style.display = 'block';
      return payload;
    }

    function download(filename, content){
      const a = document.createElement('a');
      a.href = URL.createObjectURL(new Blob([content], {type: 'text/plain'}));
      a.download = filename; a.click();
      setTimeout(() => URL.revokeObjectURL(a.href), 500);
    }

    function exportJSON(){
      const payload = buildSummary();
      if(!payload.selectedCount){ alert('Seçim yok.'); return; }
      download('canli-destek-form.json', JSON.stringify(payload, null, 2));
    }
    function exportCSV(){
      const rows = ['Grup,Özellik'];
      for(const [key, items] of Object.entries(GROUPS)){
        items.filter(i=> state.selected.has(i)).forEach(i=> rows.push(`${key},"${i.replace(/"/g,'\"')}"`));
      }
      if(rows.length===1){ alert('Seçim yok.'); return; }
      download('canli-destek-ozellikler.csv', rows.join('\n'));
    }
    function copySummary(){
      const text = $('#summaryText').textContent;
      if(!text){ alert('Önce özet oluştur.'); return; }
      navigator.clipboard.writeText(text).then(()=> toast('Özet panoya kopyalandı.'))
    }

    function shareLink(){
      if(!state.selected.size){ alert('Paylaşılabilir bağlantı için en az bir seçim yap.'); return; }
      const u = new URL(location.href);
      u.searchParams.set('select', encodeURIComponent(JSON.stringify([...state.selected])));
      navigator.clipboard.writeText(u.toString()).then(()=> toast('Bağlantı panoya kopyalandı.'));
      history.replaceState({}, '', u);
    }

    function toast(msg){
      const t = document.createElement('div');
      t.textContent = msg;
      t.style.position='fixed'; t.style.bottom='20px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.background='linear-gradient(135deg, var(--primary), var(--accent))'; t.style.color='#0b1220';
      t.style.padding='10px 14px'; t.style.borderRadius='12px'; t.style.boxShadow= 'var(--shadow)'; t.style.zIndex=1000; t.style.fontWeight='600';
      document.body.appendChild(t);
      setTimeout(()=> t.remove(), 1500);
    }

    // Events
    document.getElementById('q').addEventListener('input', (e)=>{ state.query = e.target.value; renderGroups(); });
    document.getElementById('selectAll').addEventListener('click', selectAllVisible);
    document.getElementById('clearAll').addEventListener('click', clearAll);
    document.getElementById('expandAll').addEventListener('click', expandAll);
    document.getElementById('collapseAll').addEventListener('click', collapseAll);
    document.getElementById('buildSummary').addEventListener('click', buildSummary);
    document.getElementById('jsonBtn').addEventListener('click', exportJSON);
    document.getElementById('csvBtn').addEventListener('click', exportCSV);
    document.getElementById('copyBtn').addEventListener('click', copySummary);
    document.getElementById('shareBtn').addEventListener('click', shareLink);

    // Init
    hydrate();
    bindCompanyFields();
    renderGroups();
  </script>
</body>
</html>